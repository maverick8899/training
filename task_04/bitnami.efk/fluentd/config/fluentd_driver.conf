<source>
  @type forward
  port 24224                       # Matches the fluentd-address in Docker Compose
  bind 0.0.0.0
</source>

<filter docker.**>
  @type parser
  key_name log
  <parse>
    @type json                     # Parse JSON format logs; adjust if logs are in another format
  </parse>
</filter>

<filter docker.**>
  @type record_transformer
  <record>
    container_name ${tag_parts[1]} # Extracts container name from the tag (e.g., docker.my_service)
    log_level info
  </record>
</filter>

<match docker.**>
  @type elasticsearch
  host elasticsearch_host           # Your Elasticsearch host
  port 9200
  index_name docker_logs            # Elasticsearch index name for Docker logs
  logstash_format true
  include_tag_key true
  tag_key @log_name
  user "#{ENV['ELASTIC_USERNAME']}" # Set from environment variables
  password "#{ENV['ELASTIC_PASSWORD']}"
  scheme https
  ssl_verify false
</match>
